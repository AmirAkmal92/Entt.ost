@{
    Layout = "~/Views/Home/_Layout.cshtml";
}

<div class="col-md-8 col-sm-12">
    <div id="panel-track" class="portlet bordered">
        <form class="form">
            <input type="text" data-bind="value: conNote" placeholder="Insert Tracking Number" />
            <button type="button" class="btn red btn-outline btn-circle" data-bind="click: search">
                <i class="fa fa-search"></i>
                <span> Search </span>
            </button>
        </form>

        <table id="tablerow" class="table table-striped table-hover table-bordered">
            <thead>
                <tr>
                    <th>Date / Time</th>
                    <th>Process</th>
                    <th>Event</th>
                </tr>
            </thead>

            <tbody data-bind="foreach: results">
                <tr>
                    <td data-bind="text:date"></td>
                    <td data-bind="text:process"></td>
                    <td data-bind="text:office"></td>
                </tr>
            </tbody>
        </table>

    </div>
</div>


@section script{
    <script type="text/javascript">

        var ViewModel = function () {
            var busy = ko.observable(false),
                conNote = ko.observable(),
                results = ko.observableArray(),
                search = function () {

                    busy(true);
                    return $.getJSON("/api/track-traces/" + ko.unwrap(conNote))
                    .done(results);
                };

            return {
                busy: busy,
                conNote: conNote,
                results: results,
                search: search
            };
        };

        $(function () {

            var vm = new ViewModel();
            ko.applyBindings(vm, document.getElementById("panel-track"));
        });
    </script>

}
